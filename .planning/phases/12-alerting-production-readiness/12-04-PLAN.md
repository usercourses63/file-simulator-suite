# Phase 12 Plan 04: Alerts Tab and Error Boundaries

## Goal
Create dedicated Alerts tab for alert history with filtering and add error boundaries to prevent component failures from crashing the dashboard.

## Scope

### Files to Create
- `src/dashboard/src/components/AlertsTab.tsx` - Dedicated alerts tab component
- `src/dashboard/src/components/AlertsTab.css` - Styling for alerts tab
- `src/dashboard/src/components/ErrorBoundary.tsx` - Error boundary wrapper component
- `src/dashboard/src/components/ErrorFallback.tsx` - Error fallback UI component

### Files to Modify
- `src/dashboard/package.json` - Add react-error-boundary package
- `src/dashboard/src/App.tsx` - Add Alerts tab and wrap components with error boundaries

## Tasks

### Task 1: Install Error Boundary Package
- [ ] Run: `npm install react-error-boundary --prefix src/dashboard`
- [ ] Verify package added to package.json dependencies (version ~5.x)
- [ ] Run: `npm install --prefix src/dashboard` to update package-lock.json

### Task 2: Create Error Fallback Component
- [ ] Create `src/dashboard/src/components/ErrorFallback.tsx`
- [ ] Accept props from FallbackProps: error (Error), resetErrorBoundary (() => void)
- [ ] Display error message in user-friendly format
- [ ] Show component stack trace in collapsed details section (for debugging)
- [ ] Add "Try Again" button that calls resetErrorBoundary
- [ ] Add "Reload Page" button that calls window.location.reload()
- [ ] Style with .error-fallback class: centered container, red border, padding, icon
- [ ] Log error to console.error for developer visibility

### Task 3: Create Error Boundary Wrapper
- [ ] Create `src/dashboard/src/components/ErrorBoundary.tsx`
- [ ] Import ErrorBoundary from react-error-boundary and ErrorFallback component
- [ ] Export withErrorBoundary HOC function: accepts Component and optional fallback
- [ ] Return wrapped component with ErrorBoundary: FallbackComponent={ErrorFallback}, onError={logError}, onReset={window.location.reload}
- [ ] Implement logError function: console.error error and componentStack
- [ ] Export ErrorBoundaryWrapper component: accepts children and wraps with ErrorBoundary
- [ ] Use ErrorBoundaryWrapper for wrapping entire tab sections

### Task 4: Create Alerts Tab Component
- [ ] Create `src/dashboard/src/components/AlertsTab.tsx`
- [ ] Import useAlerts hook from existing hooks
- [ ] Accept props: alerts (Alert[]), stats (AlertStats), loading (boolean)
- [ ] Display alert stats at top: total count, counts by severity (Info/Warning/Critical)
- [ ] Add filter controls: severity dropdown (All/Info/Warning/Critical), type dropdown (All/DiskSpace/Kafka/ServerHealth)
- [ ] Add search input: filter by title or message text
- [ ] Use useState for filterSeverity, filterType, searchText
- [ ] Filter alerts based on selected filters
- [ ] Display filtered alerts in table: timestamp, severity badge, type, title, message, status (Active/Resolved)
- [ ] Sort by triggeredAt descending (newest first)
- [ ] Add pagination: 50 alerts per page
- [ ] Use BEM styling: .alerts-tab, .alerts-tab__filters, .alerts-tab__stats, .alerts-tab__table
- [ ] Add severity badges with colors: Critical (red), Warning (orange), Info (blue)
- [ ] Add resolved badge with gray color
- [ ] Add empty state when no alerts: "No alerts found" message

### Task 5: Add Alerts Tab CSS
- [ ] Create `src/dashboard/src/components/AlertsTab.css`
- [ ] .alerts-tab: display flex, flex-direction column, gap: 1.5rem, padding: 1.5rem
- [ ] .alerts-tab__stats: display grid, grid-template-columns repeat(4, 1fr), gap: 1rem
- [ ] .alerts-tab__stat: background white, border, border-radius, padding, text-align center
- [ ] .alerts-tab__stat-value: font-size 2rem, font-weight bold, margin-bottom 0.5rem
- [ ] .alerts-tab__stat-label: color gray, text-transform uppercase, font-size 0.875rem
- [ ] .alerts-tab__filters: display flex, gap: 1rem, align-items center, flex-wrap wrap
- [ ] .alerts-tab__filter: display flex, flex-direction column, gap: 0.25rem
- [ ] .alerts-tab__table: width 100%, border-collapse collapse, background white
- [ ] .alerts-tab__table th: background gray, padding 0.75rem, text-align left
- [ ] .alerts-tab__table td: padding 0.75rem, border-bottom 1px solid
- [ ] .alert-badge: display inline-block, padding 0.25rem 0.75rem, border-radius, font-size 0.75rem, font-weight bold
- [ ] .alert-badge--critical: background red-100, color red-800
- [ ] .alert-badge--warning: background orange-100, color orange-800
- [ ] .alert-badge--info: background blue-100, color blue-800
- [ ] .alert-status--resolved: color gray, font-style italic

### Task 6: Wrap Tab Components with Error Boundaries
- [ ] Edit `src/dashboard/src/App.tsx`
- [ ] Import withErrorBoundary from ErrorBoundary component
- [ ] Wrap each tab component: const SafeServersTab = withErrorBoundary(ServersTab)
- [ ] Apply to: ServersTab, FilesTab, HistoryTab, KafkaTab, AlertsTab
- [ ] Use safe components in tab rendering: {activeTab === 'servers' && <SafeServersTab ... />}
- [ ] Add error boundary around entire app content (below header): wrap tab content in ErrorBoundaryWrapper
- [ ] Keep header and navigation outside error boundary (prevent total UI loss)

### Task 7: Add Alerts Tab to Navigation
- [ ] Edit `src/dashboard/src/App.tsx`
- [ ] Add "alerts" to tab options in header navigation
- [ ] Add tab button: <button onClick={() => setActiveTab('alerts')} className={activeTab === 'alerts' ? 'active' : ''}>Alerts</button>
- [ ] Add conditional rendering: {activeTab === 'alerts' && <SafeAlertsTab alerts={alertHistory} stats={stats} loading={false} />}
- [ ] Pass alertHistory from useAlerts hook to AlertsTab
- [ ] Position Alerts tab after Kafka tab in navigation order

## Verification
```bash
# Check package installed
cat src/dashboard/package.json | grep react-error-boundary

# Build dashboard
cd src/dashboard && npm run build

# Check for errors
npm run lint --prefix src/dashboard
```

## Success Criteria
- [ ] react-error-boundary package installed in dashboard
- [ ] ErrorFallback component displays user-friendly error messages
- [ ] ErrorFallback shows "Try Again" and "Reload Page" buttons
- [ ] withErrorBoundary HOC wraps components with error boundary
- [ ] AlertsTab displays alert statistics at top (total, by severity)
- [ ] AlertsTab provides filter controls (severity, type, search)
- [ ] AlertsTab shows filtered alerts in sortable table
- [ ] Alert severity badges color-coded (red/orange/blue)
- [ ] Resolved alerts shown with gray "Resolved" status
- [ ] Pagination shows 50 alerts per page
- [ ] Empty state displays when no alerts match filters
- [ ] All major tab components wrapped with error boundaries in App.tsx
- [ ] Alerts tab accessible from navigation between Kafka and end
- [ ] Error in one tab component does not crash entire dashboard
- [ ] CSS provides clean table layout and responsive filters

## Commit
```bash
git add src/dashboard
git commit -m "feat(12-04): add alerts tab and error boundaries

- Add react-error-boundary package for component isolation
- Add ErrorBoundary HOC and ErrorFallback component
- Add AlertsTab with stats, filters, search, and pagination
- Wrap all major tabs with error boundaries (Servers/Files/History/Kafka/Alerts)
- Add Alerts tab to navigation
- Add CSS styling for alerts table and severity badges
- Prevent component failures from crashing entire dashboard

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>"
```
